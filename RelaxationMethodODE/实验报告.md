# 项目：常微分方程的松弛迭代法 - 实验报告

**学生姓名：** [王宏阳] **学号：** [20231050108] **完成日期：** [6.18]

## 1. 实验目的

学习松弛迭代法求解常微分方程边值问题，通过抛体运动实例掌握数值方法的实现。

## 2. 核心算法

### 2.1 算法思路

使用二阶中心差分近似二阶导数，将微分方程转化为差分方程，然后通过松弛迭代法求解边值问题。

### 2.2 关键代码片段

```python
# 松弛迭代核心代码
while delta > tol:
    x_new = np.copy(x)
    x_new[1:-1] = 0.5 * (h * h * g + x[2:] + x[:-2])
    delta = np.max(np.abs(x_new - x))
    x = x_new
```

## 3. 实验结果

### 3.1 主要输出

- 最大高度：[121.59] m
- 到达最大高度时间：[5.00] s
- 迭代收敛次数：[10000] 次

### 3.2 结果验证
![image](https://github.com/user-attachments/assets/314dc748-b553-48ec-bbfd-04a3e74a7a76)

- 边界条件满足：x(0) = 0, x(10) = 0
- 轨迹对称性：关于 t = 5s 对称
- 物理合理性：抛体轨迹呈抛物线形状

## 4. 问题与收获

### 4.1 主要问题

1. 收敛速度较慢：当时间步长 h 较大时，迭代次数显著增加。
2. 初始猜测影响：若初始解数组未满足边界条件，会导致迭代发散。

### 4.2 解决方法

1. 优化步长与容差：选择 h = 0.1 和  $tol = 1e-6$ 平衡精度与效率。
2. 显式设置边界条件：初始化时直接固定x[0] = x[-1] = 0，避免迭代更新边界点。

### 4.3 主要收获

通过本实验掌握了松弛迭代法的基本原理，理解了边值问题与初值问题的区别，学会了用数值方法求解物理问题。

## 5. 思考题（可选）

1. 为什么松弛法适合求解边值问题而不是初值问题？
 - 边值问题特点：需同时满足两端条件，无法像初值问题（如欧拉法）通过递推直接求解，需全局调整解以满足所有约束。
 - 松弛法优势：通过迭代更新每个节点，利用相邻节点的耦合关系逐步逼近满足所有边界条件的解，适合处理全局约束问题。
2. 如何选择合适的收敛容差和最大迭代次数？
 - 收敛容差 tol：依据问题精度需求设定（如物理问题通常取  $1e-6$~ $1e-3$）。过小的 tol 会增加迭代次数，过大则导致解误差超标。
 - 最大迭代次数 max_iter：参考问题规模与经验值，避免因算法发散导致程序卡死。可通过监测迭代次数与 delta 的关系，动态调整 max_iter 以优化效率。
## 6. 总结
   本实验通过松弛迭代法成功求解了抛体运动的边值问题，验证了数值解的物理合理性。松弛法作为一种迭代求解方法，通过局部更新与收敛判断，避免了直接求解大型线性方程组，在处理稀疏系统时具有显著优势。后续可进一步探索高斯 - 赛德尔迭代、超松弛法等优化策略，提升算法收敛速度。
